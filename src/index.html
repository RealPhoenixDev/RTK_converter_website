<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Conventer tool website</title>
    <link rel="stylesheet" href="./style.css" />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"
    ></script>
  </head>
  <body style="position: relative">
    <div class="window_container" id="mainWindowContainer"></div>
    <div class="window_container" id="usernameWindowContainer"></div>
    <div class="window_container" id="taskBoardContainer"></div>
    <div
      class="window_container taskWindowContainer"
      id="taskWindowContainer"
      style="display: none"
    ></div>
  </body>
  <div class="window_container" id="tagSelectContainer"></div>
  <div class="window_container" id="tagCreateContainer"></div>
  <script src="./lib/data/window_loader.js"></script>
  <script src="./lib/data/data_manager.js"></script>
  <script src="./script.js"></script>
  <script>
    async function initializeData() {
      const boardContainer = document.getElementById("folder_container");
      <!-- I did this because any other solution would take too much time I cannot be bothered -->
      boardContainer.innerHTML = `<div class="folder_element" style="order: 2; border: none">
        <div id="folderCreateBtn">
            <button>
                <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g
                        id="SVGRepo_tracerCarrier"
                        stroke-linecap="round"
                        stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path
                            d="M6 12H12M18 12H12M12 12V6M12 12V18"
                            stroke="#7c4e6c"
                            stroke-width="1.5"
                            stroke-linecap="round"
                            stroke-linejoin="round"></path>
                    </g>
                </svg>
            </button>
        </div>
    </div>`;
      for (let i = 0; i < getFolderCount(); i++) {
        await insertTemplate(
          boardContainer,
          "./lib/templates/folder.html",
          i,
          {
            folderName: getFolderIndexKey(i),
          },
          "./lib/data/folder_data_manager.js"
        );
        const scriptElement = document.getElementById(i + "_Scr");
        passDataToScript(scriptElement, { folderData: true }, i);
      }
    }
    document.addEventListener("loaded", () => {
      initializeData();
      insertScript(
        document.body,
        "taskInfoScr",
        "./lib/data/task_info_manager.js"
      );
      insertScript(document.body, "tagSelectScr", "./lib/data/tag_manager.js");
      const folderCreateBtn = document.getElementById("folderCreateBtn");
      folderCreateBtn.addEventListener("click", async () => {
        const boardContainer = document.getElementById("folder_container");
        await addFolder("Folder Name " + getFolderCount());
        await insertTemplate(
          boardContainer,
          "./lib/templates/folder.html",
          getFolderCount() - 1,
          {
            folderName: getFolderIndexKey(getFolderCount() - 1),
          },
          "./lib/data/folder_data_manager.js"
        );
        const scriptElement = document.getElementById(
          getFolderCount() - 1 + "_Scr"
        );
        passDataToScript(
          scriptElement,
          { folderData: true },
          getFolderCount() - 1
        );
      });
    });
  </script>
</html>
